package com.gibbsdevops.alfred.test.it.ingest;

import com.gibbsdevops.alfred.config.CacheConfig;
import com.gibbsdevops.alfred.service.build.BuildService;
import com.gibbsdevops.alfred.service.job.JobService;
import com.gibbsdevops.alfred.test.it.TestDatabaseConfig;
import com.gibbsdevops.alfred.utils.rest.JsonRestClient;
import com.gibbsdevops.alfred.utils.rest.MockJsonRestClient;
import com.gibbsdevops.alfred.utils.rest.RestRequest;
import com.gibbsdevops.alfred.web.controller.IngestApiController;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.messaging.simp.SimpMessagingTemplate;

import static org.mockito.Mockito.mock;

@Configuration
@Import({TestDatabaseConfig.class, CacheConfig.class})
@ComponentScan("com.gibbsdevops.alfred.service.ingest,com.gibbsdevops.alfred.repository,com.gibbsdevops.alfred.service.github")
@EnableJpaRepositories("com.gibbsdevops.alfred.dao")
public class IngestTestConfig {

    @Bean
    public IngestApiController ingestApiController() {
        return new IngestApiController();
    }

    @Bean
    public JsonRestClient jsonRestClient() {
        MockJsonRestClient mock = new MockJsonRestClient();
        mock.addRequest(RestRequest.get("https://api.github.com/orgs/gibbsdevops"), "{\"login\":\"gibbsdevops\",\"id\":10710439,\"url\":\"https://api.github.com/orgs/gibbsdevops\",\"repos_url\":\"https://api.github.com/orgs/gibbsdevops/repos\",\"events_url\":\"https://api.github.com/orgs/gibbsdevops/events\",\"members_url\":\"https://api.github.com/orgs/gibbsdevops/members{/member}\",\"public_members_url\":\"https://api.github.com/orgs/gibbsdevops/public_members{/member}\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/10710439?v=3\",\"description\":null,\"public_repos\":1,\"public_gists\":0,\"followers\":0,\"following\":0,\"html_url\":\"https://github.com/gibbsdevops\",\"created_at\":\"2015-01-26T15:18:10Z\",\"updated_at\":\"2015-04-08T02:12:23Z\",\"type\":\"Organization\"}\n");
        mock.addRequest(RestRequest.get("https://api.github.com/users/shanegibbs"), "{\"login\":\"shanegibbs\",\"id\":2838876,\"avatar_url\":\"https://avatars.githubusercontent.com/u/2838876?v=3\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/shanegibbs\",\"html_url\":\"https://github.com/shanegibbs\",\"followers_url\":\"https://api.github.com/users/shanegibbs/followers\",\"following_url\":\"https://api.github.com/users/shanegibbs/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/shanegibbs/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/shanegibbs/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/shanegibbs/subscriptions\",\"organizations_url\":\"https://api.github.com/users/shanegibbs/orgs\",\"repos_url\":\"https://api.github.com/users/shanegibbs/repos\",\"events_url\":\"https://api.github.com/users/shanegibbs/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/shanegibbs/received_events\",\"type\":\"User\",\"site_admin\":false,\"name\":\"Shane Gibbs\",\"company\":\"\",\"blog\":\"\",\"location\":\"Chicago, IL\",\"email\":\"\",\"hireable\":true,\"bio\":null,\"public_repos\":11,\"public_gists\":3,\"followers\":1,\"following\":0,\"created_at\":\"2012-11-19T23:24:28Z\",\"updated_at\":\"2015-04-18T19:50:27Z\"}\n");
        mock.addRequest(RestRequest.get("https://api.github.com/repos/gibbsdevops/alfred"), "{\"id\":30513996,\"name\":\"alfred\",\"full_name\":\"gibbsdevops/alfred\",\"owner\":{\"login\":\"gibbsdevops\",\"id\":10710439,\"avatar_url\":\"https://avatars.githubusercontent.com/u/10710439?v=3\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/gibbsdevops\",\"html_url\":\"https://github.com/gibbsdevops\",\"followers_url\":\"https://api.github.com/users/gibbsdevops/followers\",\"following_url\":\"https://api.github.com/users/gibbsdevops/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/gibbsdevops/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/gibbsdevops/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/gibbsdevops/subscriptions\",\"organizations_url\":\"https://api.github.com/users/gibbsdevops/orgs\",\"repos_url\":\"https://api.github.com/users/gibbsdevops/repos\",\"events_url\":\"https://api.github.com/users/gibbsdevops/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/gibbsdevops/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/gibbsdevops/alfred\",\"description\":\"Alfred CI Server\",\"fork\":false,\"url\":\"https://api.github.com/repos/gibbsdevops/alfred\",\"forks_url\":\"https://api.github.com/repos/gibbsdevops/alfred/forks\",\"keys_url\":\"https://api.github.com/repos/gibbsdevops/alfred/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/gibbsdevops/alfred/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/gibbsdevops/alfred/teams\",\"hooks_url\":\"https://api.github.com/repos/gibbsdevops/alfred/hooks\",\"issue_events_url\":\"https://api.github.com/repos/gibbsdevops/alfred/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/gibbsdevops/alfred/events\",\"assignees_url\":\"https://api.github.com/repos/gibbsdevops/alfred/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/gibbsdevops/alfred/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/gibbsdevops/alfred/tags\",\"blobs_url\":\"https://api.github.com/repos/gibbsdevops/alfred/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/gibbsdevops/alfred/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/gibbsdevops/alfred/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/gibbsdevops/alfred/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/gibbsdevops/alfred/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/gibbsdevops/alfred/languages\",\"stargazers_url\":\"https://api.github.com/repos/gibbsdevops/alfred/stargazers\",\"contributors_url\":\"https://api.github.com/repos/gibbsdevops/alfred/contributors\",\"subscribers_url\":\"https://api.github.com/repos/gibbsdevops/alfred/subscribers\",\"subscription_url\":\"https://api.github.com/repos/gibbsdevops/alfred/subscription\",\"commits_url\":\"https://api.github.com/repos/gibbsdevops/alfred/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/gibbsdevops/alfred/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/gibbsdevops/alfred/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/gibbsdevops/alfred/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/gibbsdevops/alfred/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/gibbsdevops/alfred/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/gibbsdevops/alfred/merges\",\"archive_url\":\"https://api.github.com/repos/gibbsdevops/alfred/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/gibbsdevops/alfred/downloads\",\"issues_url\":\"https://api.github.com/repos/gibbsdevops/alfred/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/gibbsdevops/alfred/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/gibbsdevops/alfred/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/gibbsdevops/alfred/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/gibbsdevops/alfred/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/gibbsdevops/alfred/releases{/id}\",\"created_at\":\"2015-02-09T01:58:34Z\",\"updated_at\":\"2015-04-08T02:12:23Z\",\"pushed_at\":\"2015-04-19T15:05:33Z\",\"git_url\":\"git://github.com/gibbsdevops/alfred.git\",\"ssh_url\":\"git@github.com:gibbsdevops/alfred.git\",\"clone_url\":\"https://github.com/gibbsdevops/alfred.git\",\"svn_url\":\"https://github.com/gibbsdevops/alfred\",\"homepage\":\"\",\"size\":500,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Java\",\"has_issues\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\",\"organization\":{\"login\":\"gibbsdevops\",\"id\":10710439,\"avatar_url\":\"https://avatars.githubusercontent.com/u/10710439?v=3\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/gibbsdevops\",\"html_url\":\"https://github.com/gibbsdevops\",\"followers_url\":\"https://api.github.com/users/gibbsdevops/followers\",\"following_url\":\"https://api.github.com/users/gibbsdevops/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/gibbsdevops/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/gibbsdevops/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/gibbsdevops/subscriptions\",\"organizations_url\":\"https://api.github.com/users/gibbsdevops/orgs\",\"repos_url\":\"https://api.github.com/users/gibbsdevops/repos\",\"events_url\":\"https://api.github.com/users/gibbsdevops/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/gibbsdevops/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"network_count\":0,\"subscribers_count\":1}\n");
        mock.addRequest(RestRequest.get("https://api.github.com/repos/shanegibbs/alfred-test-repo"), "{\"id\":30393711,\"name\":\"alfred-test-repo\",\"full_name\":\"shanegibbs/alfred-test-repo\",\"owner\":{\"login\":\"shanegibbs\",\"id\":2838876,\"avatar_url\":\"https://avatars.githubusercontent.com/u/2838876?v=3\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/shanegibbs\",\"html_url\":\"https://github.com/shanegibbs\",\"followers_url\":\"https://api.github.com/users/shanegibbs/followers\",\"following_url\":\"https://api.github.com/users/shanegibbs/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/shanegibbs/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/shanegibbs/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/shanegibbs/subscriptions\",\"organizations_url\":\"https://api.github.com/users/shanegibbs/orgs\",\"repos_url\":\"https://api.github.com/users/shanegibbs/repos\",\"events_url\":\"https://api.github.com/users/shanegibbs/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/shanegibbs/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/shanegibbs/alfred-test-repo\",\"description\":\"\",\"fork\":false,\"url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo\",\"forks_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/forks\",\"keys_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/teams\",\"hooks_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/hooks\",\"issue_events_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/events\",\"assignees_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/tags\",\"blobs_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/languages\",\"stargazers_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/stargazers\",\"contributors_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/contributors\",\"subscribers_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/subscribers\",\"subscription_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/subscription\",\"commits_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/merges\",\"archive_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/downloads\",\"issues_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/shanegibbs/alfred-test-repo/releases{/id}\",\"created_at\":\"2015-02-06T03:43:20Z\",\"updated_at\":\"2015-02-06T03:43:20Z\",\"pushed_at\":\"2015-02-23T02:45:50Z\",\"git_url\":\"git://github.com/shanegibbs/alfred-test-repo.git\",\"ssh_url\":\"git@github.com:shanegibbs/alfred-test-repo.git\",\"clone_url\":\"https://github.com/shanegibbs/alfred-test-repo.git\",\"svn_url\":\"https://github.com/shanegibbs/alfred-test-repo\",\"homepage\":null,\"size\":140,\"stargazers_count\":0,\"watchers_count\":0,\"language\":null,\"has_issues\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\",\"network_count\":0,\"subscribers_count\":1}\n");
        // System.out.println(new DefaultJsonRestClient().exec(RestRequest.get("https://api.github.com/repos/shanegibbs/alfred-test-repo")).getBody());
        return mock;
    }

    @Bean
    public JobService jobService() {
        return mock(JobService.class);
    }

    @Bean
    public BuildService buildService() {
        return mock(BuildService.class);
    }

    @Bean
    public SimpMessagingTemplate simpleMessagingTemplate() {
        return mock(SimpMessagingTemplate.class);
    }

}
